<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Sorting Algorithm Visualizer</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bar:#9fb6ff;
  --compare:#facc15;
  --swap:#ef4444;
  --sorted:#22c55e;
  --pivot:#9c27b0;
}
body{
  margin:0;
  font-family:Segoe UI,Arial;
  background:#f5f7fa;
}
header{
  background:#0b6623;
  color:#ffd24a;
  font-size:32px;
  padding:15px;
  font-weight:800;
}
.controls{
  background:#e6f2e6;
  padding:10px;
  display:flex;
  flex-wrap:wrap;
  gap:8px;
}
button,select,input{
  padding:8px;
  border-radius:6px;
  border:1px solid #bbb;
}
#bars{
  height:300px;
  display:flex;
  align-items:flex-end;
  gap:4px;
  margin:20px;
}
.bar{
  flex:1;
  background:var(--bar);
  border-radius:4px;
  display:flex;
  justify-content:center;
  font-size:12px;
}
.info{
  margin:10px 20px;
}
#arrayDisplay{
  margin:10px 20px;
  font-weight:600;
  color:#333;
}
</style>
</head>

<body>

<header>Comparison Sorting Algorithms</header>

<div class="controls">
  <input id="arrayInput" type="text" placeholder="Enter array e.g. 5,3,8,1,9" size="40">
  <button onclick="loadArray()">Load Array</button>

  <select id="algo">
    <option value="bubble">Bubble Sort</option>
    <option value="selection">Selection Sort</option>
    <option value="insertion">Insertion Sort</option>
    <option value="merge">Merge Sort</option>
    <option value="quick">Quick Sort</option>
  </select>

  <button onclick="start()">Start</button>
  <button onclick="pause()">Pause</button>
  <button onclick="stepBack()">Step Back</button>
  <button onclick="stepForward()">Step Forward</button>

  Speed <input id="speed" type="range" min="50" max="1000" value="200">
</div>

<div id="bars"></div>

<div id="arrayDisplay">Array: â€”</div>

<div class="info">
  Steps: <span id="step">0</span>/<span id="total">0</span> |
  Comparisons: <span id="cmp">0</span> |
  Swaps: <span id="swp">0</span>
</div>

<script>
let original=[], actions=[], step=0, timer=null;

function updateArrayText(arr){
  document.getElementById("arrayDisplay").innerText =
    "Array: " + arr.join(", ");
}

function loadArray(){
  const input=document.getElementById("arrayInput").value;
  if(!input){ 
    alert("Enter array first"); 
    return; 
  }

  original = input.split(/[ ,]+/)
                  .map(s => s.trim())
                  .filter(s => s !== "")
                  .map(Number);

  if(original.some(isNaN)){ 
    alert("Invalid numbers detected"); 
    original = [];
    return; 
  }

  actions=[]; step=0;
  render(original);
  updateArrayText(original);
  document.getElementById("step").innerText = 0;
  document.getElementById("cmp").innerText = 0;
  document.getElementById("swp").innerText = 0;
  document.getElementById("total").innerText = 0;
}

function render(arr, colorMap={}) {
  const bars=document.getElementById("bars");
  bars.innerHTML="";
  const max=Math.max(...arr);

  arr.forEach((v,i)=>{
    const b=document.createElement("div");
    b.className="bar";
    b.style.height=(v/max*250)+"px";
    b.style.background=colorMap[i]||"var(--bar)";
    b.innerText=v;
    bars.appendChild(b);
  });

  updateArrayText(arr);
}

function generateActions(){
  const algo=document.getElementById("algo").value;
  let arr=original.slice();
  actions=[];

  // Bubble Sort
  if(algo==="bubble"){
    for(let i=0;i<arr.length;i++){
      for(let j=0;j<arr.length-i-1;j++){
        actions.push({t:"c",i:j,j:j+1});
        if(arr[j]>arr[j+1]){
          actions.push({t:"s",i:j,j:j+1});
          [arr[j],arr[j+1]]=[arr[j+1],arr[j]];
        }
      }
      actions.push({t:"done",i:arr.length-i-1});
    }
  }

  // Selection Sort
  if(algo==="selection"){
    for(let i=0;i<arr.length;i++){
      let min=i;
      for(let j=i+1;j<arr.length;j++){
        actions.push({t:"c",i:min,j});
        if(arr[j]<arr[min]) min=j;
      }
      if(i!==min){
        actions.push({t:"s",i,j:min});
        [arr[i],arr[min]]=[arr[min],arr[i]];
      }
      actions.push({t:"done",i});
    }
  }

  // Insertion Sort
  if(algo==="insertion"){
    for(let i=1;i<arr.length;i++){
      let key=arr[i], j=i-1;
      while(j>=0 && arr[j]>key){
        actions.push({t:"c",i:j,j:i});
        actions.push({t:"o",i:j+1,v:arr[j]});
        arr[j+1]=arr[j]; j--;
      }
      actions.push({t:"o",i:j+1,v:key});
      arr[j+1]=key;
    }
    for(let i=0;i<arr.length;i++) actions.push({t:"done",i});
  }

  // Merge Sort
  if(algo==="merge"){
    function ms(l,r){
      if(l>=r) return;
      let m=(l+r)>>1;
      ms(l,m); ms(m+1,r);
      let temp=[],i=l,j=m+1;
      while(i<=m && j<=r){
        actions.push({t:"c",i,j});
        temp.push(arr[i]<=arr[j]?arr[i++]:arr[j++]);
      }
      while(i<=m) temp.push(arr[i++]);
      while(j<=r) temp.push(arr[j++]);
      for(let k=0;k<temp.length;k++){
        actions.push({t:"o",i:l+k,v:temp[k]});
        arr[l+k]=temp[k];
      }
    }
    ms(0,arr.length-1);
    for(let i=0;i<arr.length;i++) actions.push({t:"done",i});
  }

  // Quick Sort
  if(algo==="quick"){
    function qs(l,r){
      if(l>=r) return;
      let p=arr[r],i=l;
      actions.push({t:"p",i:r});
      for(let j=l;j<r;j++){
        actions.push({t:"c",i:j,j:r});
        if(arr[j]<p){
          actions.push({t:"s",i,j});
          [arr[i],arr[j]]=[arr[j],arr[i]];
          i++;
        }
      }
      actions.push({t:"s",i,j:r});
      [arr[i],arr[r]]=[arr[r],arr[i]];
      actions.push({t:"done",i});
      qs(l,i-1); qs(i+1,r);
    }
    qs(0,arr.length-1);
  }

  document.getElementById("total").innerText=actions.length;
}

function apply(k){
  let arr=original.slice();
  let cmp=0,swp=0,color={};

  for(let x=0;x<k;x++){
    let a=actions[x];
    if(a.t==="c") cmp++;
    if(a.t==="s"){ swp++; [arr[a.i],arr[a.j]]=[arr[a.j],arr[a.i]]; }
    if(a.t==="o"){ swp++; arr[a.i]=a.v; }
  }

  if(k>0){
    let a=actions[k-1];
    if(a.t==="c") color[a.i]=color[a.j]="var(--compare)";
    if(a.t==="s") color[a.i]=color[a.j]="var(--swap)";
    if(a.t==="o") color[a.i]="var(--swap)";
    if(a.t==="p") color[a.i]="var(--pivot)";
    if(a.t==="done") color[a.i]="var(--sorted)";
  }

  render(arr,color);
  document.getElementById("step").innerText=k;
  document.getElementById("cmp").innerText=cmp;
  document.getElementById("swp").innerText=swp;
}

function start(){
  if(actions.length===0) generateActions();
  pause();
  timer=setInterval(()=>{
    if(step<actions.length){
      step++;
      apply(step);
    } else pause();
  },document.getElementById("speed").value);
}

function pause(){ if(timer) clearInterval(timer); }
function stepForward(){ if(step<actions.length){ step++; apply(step); } }
function stepBack(){ if(step>0){ step--; apply(step); } }

</script>
</body>
</html>
